% R, bioconductor, meta-analysis, publication

# categoryCompare Paper Finally Out!

I can finally say that our publication on our `Bioconductor` package `categoryCompare` is finally published in the **Bioinformatics and Computational Biology** section of **Frontiers in Genetics**. This has been a long time coming, and I wanted to give some background on the inspiration and development of the method and software.

## TL;DR

The software package has been in development in one form or another since 2010, released to `Bioconductor` in summer 2012, and the publication has bounced around and been revised since spring of 2013, and it is finally available to you. All of the supplementary data and methods are available as an `R` package on [github](https://github.com/rmflight/ccPaper).

## Inspiration

In spring of 2010 I started as a PostDoc with Eric Rouchka. One of his collaborators, Jeff Petruska is interested in the process of collateral sprouting of neurons, especially as it compares to regeneration. Early in my PostDoc, he wanted to do a gene-level comparison of his microarray data of collateral sprouting in skin compared to previously published studies with muscle. 

Combing through the literature produced a number of genes differentially expressed in denervated muscle. However, when comparing with the genes resulting from the skin data, there was almost nothing in common and nothing that made sense. Skimming around the `Bioconductor` literature in `[GOStats](http://bioconductor.org/packages/release/bioc/vignettes/GOstats/inst/doc/GOvis.pdf)`, I was struck by Robert Gentleman's example of coloring Gene Ontology nodes by which data set they originated from. This is a very simple meta-analysis and visualization. When I tried it with the skin - muscle comparison, I got some very interesting (i.e. the Petruska group thought the results were very interpretable) results.

**Note:** At this point, because of the data sources (gene lists from publications with little to no original data), I was using the hypergeometric enrichment test in `Category` to determine significant GO terms from the two tissues.

## V 0.0000001

I started developing this idea into a simple package (i.e. collection of `R` scripts), that was able to do at least GO term enrichment, and that could be hosted on our group webserver to enable others to make use of it. Visualization and interrogation used the `imageMaps` function in Robert Gentleman's original demonstration, however any number of data sets could now be compared.

## Others

As I developed this idea, I also started looking into other possible software implementations. 

* Shen & Tseng had recently published similar work in [MAPE-I](http://www.ncbi.nlm.nih.gov/pmc/articles/PMC2865865/), but at my level of understanding it required the same identifiers. In retrospect, I should have read the paper better. However, they also did not have a released implementation with their publication. 

* [ConceptGen](http://conceptgen.ncibi.org/core/conceptGen/index.jsp) is another interesting application, that allows very similar analyses to `categoryCompare`, except that it is not possible to explore how the concepts map between multiple user supplied data sets. The only way one can relate multiple data sets is if the data sets map as a concept to another, but one cannot visualize the interrelated concepts between user supplied data sets.

* [Enrichment Map](http://www.plosone.org/article/info%3Adoi%2F10.1371%2Fjournal.pone.0013984) was another alternative, but did all of comparison mathematics in Cytoscape itself, based on enrichments calculated outside of Cytoscape. The publication does give an example of a similar type of analysis as performed by `categoryCompare`. However, I wanted everything, from enrichment calculation to visualization controlled by `R`. I did use their method of weighting the edges between annotations, however, ditching the GO directed acyclic graph (DAG) view I used initially.


## Bioconductor Package

About this time I realized that I wanted the package to fit into the `Bioconductor` ecosystem. This required a complete redesign and rewrite of the code, as I moved to actually used some sort of OOP model (S4 in this case), and creating an actual package.

The package was released to the wild in the fall of 2012, as part of `Bioconductor` v 2.10. Of course, this was the last `Bioconductor` release based on R 2.15, which brought some particular challenges in `namespaces` with the switch in R 3.0.0 the next year. 

### Graphviz to RCytoscape

The original code used the `graphviz` package to do layouts for visualization, but it was difficult to install, and did not work the way I wanted. Thankfully Paul Shannon had just developed the `RCytoscape` package the year previous, and this enabled truly interactive visualization and passing data back and forth between `R` and `Cytoscape`. 

My use of `RCytoscape` has actually lead to finding improvements in the package, and better use of it. I am also hoping to make much more use of `RCytoscape` and the `igraph` package and combining them in novel ways.

## First Publication Attempt

Our first attempt at publication focussed on the original data that inspired the method, and comparing it with gene-gene comparisons directly. We submitted to BMC Bioinformatics, and the reviews were not favorable, and took forever to get back. We actually wondered if the reviewers had read the paper that we submitted. We gave up on this venue. BTW, our last three publications have been submitted there, and the publication process has gotten worse and worse with every submission there. I don't think our papers are getting worse over the years.

## Second Publication Attempt

The second attempt was submitting to the current home in the **Bioinformatics and Computational Biology** section of **Frontiers in Genetics**. This time, although the reviews were harsh, they were fair, and actually contained **useful** critique, and pointed to a way forward. 